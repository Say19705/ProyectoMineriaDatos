---
title: "Proyecto de Minería de datos. Matrimonios de Guatemala"
author: "Ayleen Rubio 19003, Andrés Say 19705, Andreé Toledo 18439"
date: "25/3/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#"C:/Users/andre/OneDrive/Documentos/3er año/1er semestre/Minería de datos/proyecto/ProyectoMineriaDatos"

knitr::opts_knit$set(root.dir="C:/Users/andre/OneDrive/Documentos/3er año/1er semestre/Minería de datos/proyecto/ProyectoMineriaDatos")
```

# Análisis exploratorio 


```{r, echo=FALSE}
library(e1071)
library(caret)
library(magrittr)
library(dplyr)
library(plyr)
library(dplyr)
library(cluster)
library(e1071)
library(mclust)

library(fpc)
library(NbClust)
library(factoextra)
#library(tidyverse)
library(readr)

library(ppclust)
library(randomForest)
library(ggplot2)
library(broom)
library(ggpubr)

library(corrplot)
library(mctest)
library(caret)
#library(Amelia)

library(caretEnsemble)
library(psych)
library(mice)
library(GGally)
library(rpart)
library(e1071)

library(haven)

datos2009 <- read_sav("datosMat2009.sav")
datos2010 <- read_sav("datosMat2010.sav")
datos2011 <- read_sav("datosMat2011.sav")
datos2012 <- read_sav("datosMat2012.sav")
datos2013 <- read_sav("datosMat2013.sav")
datos2014 <- read_sav("datosMat2014.sav")
datos2015 <- read_sav("datosMat2015.sav")
datos2016 <- read_sav("datosMat2016.sav")
datos2017 <- read_sav("datosMat2017.sav")
datos2018 <- read_sav("datosMat2018.sav")
datos2019 <- read_sav("datosMat2019.sav")

#Se usarán como estandar las bases de 2015,2016,2017 /no se si colocar las columnas

#----------------Modificaciones 2009 -------------------
#Crear columnas en dataset 2009 ESCHOM, ESCMUJ y DIAOCU
ESCHOM <- rnorm(nrow(datos2009))
datos2009 <- cbind(datos2009, ESCHOM)
datos2009$ESCHOM <- "None"

ESCMUJ <- rnorm(nrow(datos2009))
datos2009 <- cbind(datos2009, ESCMUJ)
datos2009$ESCMUJ <- "None"

DIAOCU <- rnorm(nrow(datos2009))
datos2009 <- cbind(datos2009, DIAOCU)
datos2009$DIAOCU <- "None"
#View(datos2009)

#cambiar los nombres de NUPHON, NUPMUJ a NUNUHO, NUNUMU 2009
cnames <- colnames(datos2009)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "NUPHON"){
    nombresN[i] <- "NUNUHO"
  }
  else if(cnames[i] == "NUPMUJ"){
    nombresN[i] <- "NUNUMU"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2009) <- nombresN

#cambiar AREAG por AREAGOCU, OCUHOM, OCUMUJ por CIUOHOM, CIUOMUJ
cnames <- colnames(datos2009)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2009) <- nombresN
datos2009$AÑOREG <- ifelse(datos2009$AÑOREG == 9, 2009, datos2009$AÑOREG)
datos2009$AÑOREG <- ifelse(datos2009$AÑOREG == 10, 2010, datos2009$AÑOREG)
datos2009$AÑOOCU <- ifelse(datos2009$AÑOOCU == 9, 2009, datos2009$AÑOOCU)
datos2009$AÑOOCU <- ifelse(datos2009$AÑOOCU == 10, 2010, datos2009$AÑOOCU)

#-----------------------Modificaciones 2010--------------------
#Crear columnas en dataset 2010 NUNUHO, NUNUMU
NUNUHO <- rnorm(nrow(datos2010))
datos2010 <- cbind(datos2010,NUNUHO)
datos2010$NUNUHO <- "None"

NUNUMU <- rnorm(nrow(datos2010))
datos2010 <- cbind(datos2010, NUNUMU)
datos2010$NUNUMU <- "None"

#Poner todas en uppercase 2010
cnames <- colnames(datos2010)
mayu2010 = c()

for (i in 1:length(cnames)){
  mayu2010[i] <- toupper(cnames[i])  
}

colnames(datos2010)<-mayu2010

#cambiar AREAG por AREAGOCU, OCUHOM, OCUMUJ
cnames <- colnames(datos2010)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2010) <- nombresN
#---------------------Modificaciones 2011----------------------
#Crear columnas en dataset 2011 NUNUHO, NUNUMU
NUNUHO <- rnorm(nrow(datos2011))
datos2011 <- cbind(datos2011,NUNUHO)
datos2011$NUNUHO <- "None"

NUNUMU <- rnorm(nrow(datos2011))
datos2011 <- cbind(datos2011, NUNUMU)
datos2011$NUNUMU <- "None"


#Poner todas en uppercase 2011
cnames <- colnames(datos2011)
mayu2011 = c()

for (i in 1:length(cnames)){
  mayu2011[i] <- toupper(cnames[i])  
}

colnames(datos2011)<-mayu2011

#cambiar AREAG por AREAGOCU OCUHOM, OCUMUJ
cnames <- colnames(datos2011)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2011) <- nombresN
#-------------------------Modificaciones 2012------------------------
#Crear columnas en dataset 2012 AÑOOCU, NUNUHO, NUNUMU
AÑOOCU <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012, AÑOOCU)
datos2012$AÑOOCU <- "None"

NUNUHO <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012,NUNUHO)
datos2012$NUNUHO <- "None"

NUNUMU <- rnorm(nrow(datos2012))
datos2012 <- cbind(datos2012, NUNUMU)
datos2012$NUNUMU <- "None"

#View(datos2012)

#cambiar AREAG por AREAGOCU, OCUHOM, OCUMUJ
cnames <- colnames(datos2012)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "AREAG"){
    nombresN[i] <- "AREAGOCU"
  }
  else if(cnames[i] == "OCUHOM"){
    nombresN[i] <- "CIUOHOM"
  }
  else if(cnames[i] == "OCUMUJ"){
    nombresN[i] <- "CIUOMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2012) <- nombresN
#------------------------Modificaciones 2013------------------------
#Crear columnas en dataset 2013 AÑOOCU, NUNUHO, NUMUNU
AÑOOCU <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013, AÑOOCU)
datos2013$AÑOOCU <- "None"

NUNUHO <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013,NUNUHO)
datos2013$NUNUHO <- "None"

NUNUMU <- rnorm(nrow(datos2013))
datos2013 <- cbind(datos2013, NUNUMU)
datos2013$NUNUMU <- "None"


#hacer la división del 2013
#PUEHOM
datos2013$PUEHOM <- ifelse(datos2013$PUEHOM ==  2,1,datos2013$PUEHOM)
datos2013$PUEHOM <- ifelse(datos2013$PUEHOM ==  3,1,datos2013$PUEHOM)
datos2013$PUEHOM <- ifelse(datos2013$PUEHOM ==  5,1,datos2013$PUEHOM)
datos2013$PUEHOM <- ifelse(datos2013$PUEHOM ==  4,2,datos2013$PUEHOM)

#PUEMUJ
datos2013$PUEMUJ <- ifelse(datos2013$PUEMUJ ==  2,1,datos2013$PUEMUJ)
datos2013$PUEMUJ <- ifelse(datos2013$PUEMUJ ==  3,1,datos2013$PUEMUJ)
datos2013$PUEMUJ <- ifelse(datos2013$PUEMUJ ==  5,1,datos2013$PUEMUJ)
datos2013$PUEMUJ <- ifelse(datos2013$PUEMUJ ==  4,2,datos2013$PUEMUJ)

#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2013)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2013) <- nombresN

#-----------------------Modificaciones 2014---------------------------
#Crear columnas en dataset 2014 AÑOOCU, NUNUHO, NUNUMU
AÑOOCU <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014, AÑOOCU)
datos2014$AÑOOCU <- "None"

NUNUHO <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014,NUNUHO)
datos2014$NUNUHO <- "None"

NUNUMU <- rnorm(nrow(datos2014))
datos2014 <- cbind(datos2014, NUNUMU)
datos2014$NUNUMU <- "None"

#hacer la división del 2014
#PUEHOM
datos2014$PUEHOM <- ifelse(datos2014$PUEHOM ==  2,1,datos2014$PUEHOM)
datos2014$PUEHOM <- ifelse(datos2014$PUEHOM ==  3,1,datos2014$PUEHOM)
datos2014$PUEHOM <- ifelse(datos2014$PUEHOM ==  5,1,datos2014$PUEHOM)
datos2014$PUEHOM <- ifelse(datos2014$PUEHOM ==  4,2,datos2014$PUEHOM)

#PUEMUJ
datos2014$PUEMUJ <- ifelse(datos2014$PUEMUJ ==  2,1,datos2014$PUEMUJ)
datos2014$PUEMUJ <- ifelse(datos2014$PUEMUJ ==  3,1,datos2014$PUEMUJ)
datos2014$PUEMUJ <- ifelse(datos2014$PUEMUJ ==  5,1,datos2014$PUEMUJ)
datos2014$PUEMUJ <- ifelse(datos2014$PUEMUJ ==  4,2,datos2014$PUEMUJ)

#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2014)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2014) <- nombresN
#-------------------Modificaciones 2015--------------------------
#hacer la división del 2015
#PUEHOM
datos2015$PUEHOM <- ifelse(datos2015$PUEHOM ==  2,1,datos2015$PUEHOM)
datos2015$PUEHOM <- ifelse(datos2015$PUEHOM ==  3,1,datos2015$PUEHOM)
datos2015$PUEHOM <- ifelse(datos2015$PUEHOM ==  5,1,datos2015$PUEHOM)
datos2015$PUEHOM <- ifelse(datos2015$PUEHOM ==  4,2,datos2015$PUEHOM)

#PUEMUJ
datos2015$PUEMUJ <- ifelse(datos2015$PUEMUJ ==  2,1,datos2015$PUEMUJ)
datos2015$PUEMUJ <- ifelse(datos2015$PUEMUJ ==  3,1,datos2015$PUEMUJ)
datos2015$PUEMUJ <- ifelse(datos2015$PUEMUJ ==  5,1,datos2015$PUEMUJ)
datos2015$PUEMUJ <- ifelse(datos2015$PUEMUJ ==  4,2,datos2015$PUEMUJ)

#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2015)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2015) <- nombresN
#-------------------Modificaciones 2016--------------------------
#hacer la división del 2016
#PUEHOM
datos2016$PUEHOM <- ifelse(datos2016$PUEHOM ==  2,1,datos2016$PUEHOM)
datos2016$PUEHOM <- ifelse(datos2016$PUEHOM ==  3,1,datos2016$PUEHOM)
datos2016$PUEHOM <- ifelse(datos2016$PUEHOM ==  5,1,datos2016$PUEHOM)
datos2016$PUEHOM <- ifelse(datos2016$PUEHOM ==  4,2,datos2016$PUEHOM)

#PUEMUJ
datos2016$PUEMUJ <- ifelse(datos2016$PUEMUJ ==  2,1,datos2016$PUEMUJ)
datos2016$PUEMUJ <- ifelse(datos2016$PUEMUJ ==  3,1,datos2016$PUEMUJ)
datos2016$PUEMUJ <- ifelse(datos2016$PUEMUJ ==  5,1,datos2016$PUEMUJ)
datos2016$PUEMUJ <- ifelse(datos2016$PUEMUJ ==  4,2,datos2016$PUEMUJ)
 
#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2016)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2016) <- nombresN
#-------------------Modificaciones 2017--------------------------
#hacer la división del 2017
#PUEHOM
datos2017$PUEHOM <- ifelse(datos2017$PUEHOM ==  2,1,datos2017$PUEHOM)
datos2017$PUEHOM <- ifelse(datos2017$PUEHOM ==  3,1,datos2017$PUEHOM)
datos2017$PUEHOM <- ifelse(datos2017$PUEHOM ==  5,1,datos2017$PUEHOM)
datos2017$PUEHOM <- ifelse(datos2017$PUEHOM ==  4,2,datos2017$PUEHOM)

#PUEMUJ
datos2017$PUEMUJ <- ifelse(datos2017$PUEMUJ ==  2,1,datos2017$PUEMUJ)
datos2017$PUEMUJ <- ifelse(datos2017$PUEMUJ ==  3,1,datos2017$PUEMUJ)
datos2017$PUEMUJ <- ifelse(datos2017$PUEMUJ ==  5,1,datos2017$PUEMUJ)
datos2017$PUEMUJ <- ifelse(datos2017$PUEMUJ ==  4,2,datos2017$PUEMUJ)

#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2017)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2017) <- nombresN
#-------------------Modificaciones 2018--------------------------
#Crear columna AREAGOCU en dataset 2018
AREAGOCU <- rnorm(nrow(datos2018))
datos2018 <- cbind(datos2018, AREAGOCU)
datos2018$AREAGOCU <- "None"

#PUEHOM
datos2018$PUEHOM <- ifelse(datos2018$PUEHOM ==  2,1,datos2018$PUEHOM)
datos2018$PUEHOM <- ifelse(datos2018$PUEHOM ==  3,1,datos2018$PUEHOM)
datos2018$PUEHOM <- ifelse(datos2018$PUEHOM ==  5,1,datos2018$PUEHOM)
datos2018$PUEHOM <- ifelse(datos2018$PUEHOM ==  4,2,datos2018$PUEHOM)

#PUEMUJ
datos2018$PUEMUJ <- ifelse(datos2018$PUEMUJ ==  2,1,datos2018$PUEMUJ)
datos2018$PUEMUJ <- ifelse(datos2018$PUEMUJ ==  3,1,datos2018$PUEMUJ)
datos2018$PUEMUJ <- ifelse(datos2018$PUEMUJ ==  5,1,datos2018$PUEMUJ)
datos2018$PUEMUJ <- ifelse(datos2018$PUEMUJ ==  4,2,datos2018$PUEMUJ)
 
#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2018)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2018) <- nombresN
#-------------------Modificaciones 2019--------------------------
#Crear columna AREAGOCU en dataset 2019
AREAGOCU <- rnorm(nrow(datos2019))
datos2019 <- cbind(datos2019, AREAGOCU)
datos2019$AREAGOCU <- "None"

#PUEHOM
datos2019$PUEHOM <- ifelse(datos2019$PUEHOM ==  2,1,datos2019$PUEHOM)
datos2019$PUEHOM <- ifelse(datos2019$PUEHOM ==  3,1,datos2019$PUEHOM)
datos2019$PUEHOM <- ifelse(datos2019$PUEHOM ==  5,1,datos2019$PUEHOM)
datos2019$PUEHOM <- ifelse(datos2019$PUEHOM ==  4,2,datos2019$PUEHOM)

#PUEMUJ
datos2019$PUEMUJ <- ifelse(datos2019$PUEMUJ ==  2,1,datos2019$PUEMUJ)
datos2019$PUEMUJ <- ifelse(datos2019$PUEMUJ ==  3,1,datos2019$PUEMUJ)
datos2019$PUEMUJ <- ifelse(datos2019$PUEMUJ ==  5,1,datos2019$PUEMUJ)
datos2019$PUEMUJ <- ifelse(datos2019$PUEMUJ ==  4,2,datos2019$PUEMUJ)

#cambiar los nombres de PUEHOM Y PUEMUJ a GETHOM GETMUJ
cnames <- colnames(datos2019)
nombresN = c()
for(i in 1:length(cnames)){
  if(cnames[i] == "PUEHOM"){
    nombresN[i] <- "GETHOM"
  }
  else if(cnames[i] == "PUEMUJ"){
    nombresN[i] <- "GETMUJ"
  }
  else{
    nombresN[i] <- cnames[i]
  }
}
colnames(datos2019) <- nombresN
#----------------------------------------------------------------

#Ver databeses
# View(datos2009)
# View(datos2010)
# View(datos2011)
# View(datos2012)
# View(datos2013)
# View(datos2014)
# View(datos2015)
# View(datos2016)
# View(datos2017)
# View(datos2018)
# View(datos2019)
#---------- Ya con todas las bases con las mismas columnas (cant columnas y nombres) podemos unirlas 
#------------------------Unión de las bases-------------------------
#---------- Ya con todas las bases con las mismas columnas (cant columnas y nombres) podemos unirlas 
datos2009 <- datos2009 %>%
  mutate_if(is.labelled,list(as_factor))
datos2010 <- datos2010 %>%
  mutate_if(is.labelled,list(as_factor))
datos2011 <- datos2011 %>%
  mutate_if(is.labelled,list(as_factor))
datos2012 <- datos2012 %>%
  mutate_if(is.labelled,list(as_factor))
datos2013 <- datos2013 %>%
  mutate_if(is.labelled,list(as_factor))
datos2014 <- datos2014 %>%
  mutate_if(is.labelled,list(as_factor))
datos2015 <- datos2015 %>%
  mutate_if(is.labelled,list(as_factor))
datos2016 <- datos2016 %>%
  mutate_if(is.labelled,list(as_factor))
datos2017 <- datos2017 %>%
  mutate_if(is.labelled,list(as_factor))
datos2018 <- datos2018 %>%
  mutate_if(is.labelled,list(as_factor))
datos2019 <- datos2019 %>%
  mutate_if(is.labelled,list(as_factor))

l = list(datos2009,datos2010,datos2011,datos2012,datos2013,datos2014,datos2015,datos2016,datos2017,datos2018,datos2019)
datosMatrimonio <- do.call("rbind",l)
datosMatrimonio$EDADHOM <- as.numeric(factor(datosMatrimonio$EDADHOM))
datosMatrimonio$EDADMUJ <- as.numeric(factor(datosMatrimonio$EDADMUJ))
```
## Informe de análisis exploratorio 
En este informe usted podrá leer los hallazgos sobre los matrimonios, basado en los datos obtenidos del INE

```{r Matrimonios, echo=FALSE}
summary(datosMatrimonio)
```
En el siguiente cuadro se muestra el tipo de dato de cada variable:

```{r data, echo=FALSE}
#
str(datosMatrimonio)
```
El dataset tiene 23 variables, el departamento, municipalidad, mes y año de registro, la casificación de la unión, las edades de los hombres y mujer, el grupo étnico de los hombres y mujeres, su nacionalidad, su oficio, la cantidad de nupcias de cada uno. Luego tambien se encuentran las variables de ocurrencia. el departamento, municipalidad, mes, año, area y dia de ocurrencia. Por último se encuentra la escolaridad de cada uno.
Las variables más interesantes parece ser los que proporcionan información de la fecha del matrimonio. 
Otra con gran potencial, son las edades de los cónyuges, ya que con ellas podemos analizar cual es la tendencia de matrimonios de menores, diferencias de edades etc.


# Análisis de variables cuantitativas
## Registros de matrimonio
### Prueba de normalidad para  registros de matrimonios:
```{r normalHist, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = datosMatrimonio, aes(x = AÑOREG)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(datosMatrimonio$popularity),
                            sd = sd(datosMatrimonio$popularity)))+
  ggtitle("Histograma con curva normal teórica de los registros de matrimonios por año") + 
  theme_bw()
```  
Como se esparía, no existe una relación visible en el histograma de registros de matrimonios, parece ser bastante constante durante los años
### Diagrama de caja y bigotes
```{r normalBox, echo=FALSE}
boxplot(datosMatrimonio$AÑOREG, main = "Caja y Bigotes de registro de matrimonios por año", xlab = "Registro por año")
```
Como dicho anteriormente, no hay muchos grupos atípicos ya que se concentran dentro de un intervalo.
### Diagrama de qqnormal
```{r normalQQ, echo=FALSE}
qqnorm(datosMatrimonio$AÑOREG, col="blue")
qqline(datosMatrimonio$AÑOREG, col="red")
```
Aunque parece seguir una distribución normal, hay bastantes datos que se encuentran fuera de la linea de tendencia.
## Registros de Edad hombre
### Prueba de normalidad para la edad del hombre:
```{r normalHistEdadHombre, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = datosMatrimonio, aes(x = EDADHOM)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(datosMatrimonio$EDADHOM),
                            sd = sd(datosMatrimonio$EDADHOM)))+
  ggtitle("Histograma con curva normal teórica de las edades de los hombres") + 
  theme_bw()
```  
En este histograma se puede ver que tiene relativamente forma de campana, sin embargo es evidente que tiene un sesgo hacia la izquierda.

###Diagrama de caja y bigotes
```{r normalBoxEdadHombre, echo=FALSE}
boxplot(datosMatrimonio$EDADHOM, main = "Caja y Bigotes de edad de los hombres al casarse", xlab = "edad")
```
Se evidencia la gran cantidad de datos atípicos en el diagrama, se encuentran muy dispersos arriba de la media

###Diagrama qqnormal
```{r normalQQEdadHombre, echo=FALSE}
qqnorm(datosMatrimonio$EDADHOM, col="blue")
qqline(datosMatrimonio$EDADHOM, col="red")
```
Es muy notable en el diagrama qqnormal que los datos no siguen una distribución acorde a la linea de tendencia.

## Registros de edad de mujeres
### Prueba de normalidad para la edad de la mujer:
```{r normalHistEdadMuje, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = datosMatrimonio, aes(x = EDADMUJ)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(datosMatrimonio$EDADMUJ),
                            sd = sd(datosMatrimonio$EDADMUJ)))+
  ggtitle("Histograma con curva normal teórica de las edades de las mujeres") + 
  theme_bw()
```  
De la misma manera que en el histograma de hombres, hay una forma relativa de campana, sin embargo se nota un gran sesgo a la izquierda.
###Diagrama de caja y bigotes
```{r normalBoxEdadMujer, echo=FALSE}
boxplot(datosMatrimonio$EDADMUJ, main = "Caja y Bigotes de edad de las mujeres al casarse", xlab = "edad")
```
En este diagrama de caja y bigotes es posible ver una gran cantidad de datos atípicos, muy similar al diagrama de la edad de los hombres
###Diagrama qqnormal
```{r normalQQEdadMujer, echo=FALSE}
qqnorm(datosMatrimonio$EDADMUJ, col="blue")
qqline(datosMatrimonio$EDADMUJ, col="red")
```
Los valores en este diagrama evidentemente no siguen con una distribución normal ya que no esán sobre la linea de tendencia.

## Tabla de frecuencias para variables cualitativas

### Tabla de frecuencias para el departamento de ocurrencia
```{r frecuenciaDepartamento, echo=FALSE}

#DepOcurren <- data.frame(table(do.call(c, lapply(datosMatrimonio$DEPOCU, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$DEPOCU)
```
### Tabla de frecuencias para el municipio de ocurrencia
```{r frecuenciaMunicipio, echo=FALSE}

#MuniOcurren <- data.frame(table(do.call(c, lapply(datosMatrimonio$MUPOCU, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$MUPOCU)
```

### Tabla de frecuencias para LA escolaridad del hombre
```{r frecuenciaEscolaridadHombre, echo=FALSE}

#EscolHom <- data.frame(table(do.call(c, lapply(datosMatrimonio$ESCHOM, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$ESCHOM)
```

### Tabla de frecuencias para LA escolaridad de la Mujer
```{r frecuenciaEscolaridadMujer, echo=FALSE}

#EscolMuj <- data.frame(table(do.call(c, lapply(datosMatrimonio$ESCMUJ, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$ESCMUJ)
```

### Tabla de frecuencias para el grupo étnico del hombre
```{r frecuenciaEtniaHombre, echo=FALSE}
#EtHom <- data.frame(table(do.call(c, lapply(datosMatrimonio$GETHOM, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$GETHOM)
```

### Tabla de frecuencias para el grupo étnico de la mujer
```{r frecuenciaEtniaMujer, echo=FALSE}

#EtHom <- data.frame(table(do.call(c, lapply(datosMatrimonio$GETMUJ, function(x) unlist(strsplit(x, "\\|"))))))
table(datosMatrimonio$GETMUJ)
```











